<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
  <meta name="theme-color" content="#2c3e50">
  <title>ãƒ¢ãƒã‚¤ãƒ«æ©Ÿèƒ½ãƒ‡ãƒ¢ | ç‹©çŒŸå…è¨±è©¦é¨“</title>
  <link rel="stylesheet" href="mobile-optimized.css">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }

    .demo-section {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .demo-title {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 12px;
      color: #2c3e50;
    }

    .demo-description {
      font-size: 14px;
      color: #7f8c8d;
      margin-bottom: 16px;
    }

    .demo-button {
      background: #3498db;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      margin: 4px;
    }

    .demo-button:active {
      transform: scale(0.97);
    }

    .swipe-area {
      width: 100%;
      height: 200px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 18px;
      font-weight: bold;
      user-select: none;
    }

    .device-info-table {
      width: 100%;
      border-collapse: collapse;
    }

    .device-info-table td {
      padding: 8px;
      border-bottom: 1px solid #ecf0f1;
    }

    .device-info-table td:first-child {
      font-weight: bold;
      color: #2c3e50;
    }

    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
    }

    .status-online {
      background: #2ecc71;
    }

    .status-offline {
      background: #e74c3c;
    }

    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .metric-card {
      background: #ecf0f1;
      padding: 12px;
      border-radius: 8px;
      text-align: center;
    }

    .metric-value {
      font-size: 24px;
      font-weight: bold;
      color: #2c3e50;
    }

    .metric-label {
      font-size: 12px;
      color: #7f8c8d;
      margin-top: 4px;
    }
  </style>
</head>
<body>
  <h1 style="text-align: center; color: #2c3e50;">ğŸ“± ãƒ¢ãƒã‚¤ãƒ«æ©Ÿèƒ½ãƒ‡ãƒ¢</h1>

  <!-- ãƒ‡ãƒã‚¤ã‚¹æƒ…å ± -->
  <div class="demo-section">
    <div class="demo-title">ğŸ” ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±</div>
    <table class="device-info-table" id="device-info">
      <tr>
        <td>èª­ã¿è¾¼ã¿ä¸­...</td>
        <td></td>
      </tr>
    </table>
  </div>

  <!-- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ…‹ -->
  <div class="demo-section">
    <div class="demo-title">ğŸŒ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ…‹</div>
    <p>
      <span class="status-indicator" id="network-status"></span>
      <span id="network-text">ç¢ºèªä¸­...</span>
    </p>
    <button class="demo-button" onclick="testNetworkStatus()">çŠ¶æ…‹ã‚’ç¢ºèª</button>
  </div>

  <!-- ãƒã‚¤ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ -->
  <div class="demo-section">
    <div class="demo-title">ğŸ“³ ãƒã‚¤ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</div>
    <div class="demo-description">ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨æŒ¯å‹•ã—ã¾ã™ï¼ˆå¯¾å¿œç«¯æœ«ã®ã¿ï¼‰</div>
    <button class="demo-button" onclick="testVibrate(50)">çŸ­ã„æŒ¯å‹•</button>
    <button class="demo-button" onclick="testVibrate(100)">ä¸­ç¨‹åº¦</button>
    <button class="demo-button" onclick="testVibrate(200)">é•·ã„æŒ¯å‹•</button>
    <button class="demo-button" onclick="testVibratePattern()">ãƒ‘ã‚¿ãƒ¼ãƒ³æŒ¯å‹•</button>
  </div>

  <!-- ã‚¹ãƒ¯ã‚¤ãƒ—ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ -->
  <div class="demo-section">
    <div class="demo-title">ğŸ‘† ã‚¹ãƒ¯ã‚¤ãƒ—ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼</div>
    <div class="demo-description">ä¸‹ã®ã‚¨ãƒªã‚¢ã‚’ã‚¹ãƒ¯ã‚¤ãƒ—ã—ã¦ãã ã•ã„</div>
    <div class="swipe-area swipeable" id="swipe-area">
      ã‚¹ãƒ¯ã‚¤ãƒ—ã—ã¦ã­ï¼
    </div>
    <p id="swipe-result" style="text-align: center; margin-top: 12px; color: #7f8c8d;">
      çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™
    </p>
  </div>

  <!-- ã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼ -->
  <div class="demo-section">
    <div class="demo-title">ğŸ’¬ ã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼ï¼ˆé€šçŸ¥ï¼‰</div>
    <div class="demo-description">ç”»é¢ä¸‹éƒ¨ã«é€šçŸ¥ã‚’è¡¨ç¤º</div>
    <button class="demo-button" onclick="showSnackbar('âœ… æˆåŠŸã—ã¾ã—ãŸ')">æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</button>
    <button class="demo-button" onclick="showSnackbar('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ')">ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</button>
    <button class="demo-button" onclick="showSnackbar('â„¹ï¸ æƒ…å ±ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã™')">æƒ…å ±ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</button>
  </div>

  <!-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ -->
  <div class="demo-section">
    <div class="demo-title">ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬</div>
    <div class="metrics-grid" id="performance-metrics">
      <div class="metric-card">
        <div class="metric-value">--</div>
        <div class="metric-label">DOMèª­ã¿è¾¼ã¿</div>
      </div>
      <div class="metric-card">
        <div class="metric-value">--</div>
        <div class="metric-label">å®Œå…¨èª­ã¿è¾¼ã¿</div>
      </div>
      <div class="metric-card">
        <div class="metric-value">--</div>
        <div class="metric-label">First Paint</div>
      </div>
      <div class="metric-card">
        <div class="metric-value">--</div>
        <div class="metric-label">FCP</div>
      </div>
    </div>
    <button class="demo-button" onclick="measurePerformance()" style="margin-top: 12px;">è¨ˆæ¸¬ã™ã‚‹</button>
  </div>

  <!-- PWAçŠ¶æ…‹ -->
  <div class="demo-section">
    <div class="demo-title">ğŸš€ PWAçŠ¶æ…‹</div>
    <table class="device-info-table" id="pwa-status">
      <tr>
        <td>Service Worker</td>
        <td id="sw-status">ç¢ºèªä¸­...</td>
      </tr>
      <tr>
        <td>ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ãƒ¢ãƒ¼ãƒ‰</td>
        <td id="standalone-status">ç¢ºèªä¸­...</td>
      </tr>
      <tr>
        <td>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿</td>
        <td id="installed-status">ç¢ºèªä¸­...</td>
      </tr>
    </table>
  </div>

  <!-- ãƒãƒƒãƒ†ãƒªãƒ¼æƒ…å ± -->
  <div class="demo-section">
    <div class="demo-title">ğŸ”‹ ãƒãƒƒãƒ†ãƒªãƒ¼æƒ…å ±</div>
    <div class="demo-description">å¯¾å¿œç«¯æœ«ã®ã¿è¡¨ç¤º</div>
    <table class="device-info-table" id="battery-info">
      <tr>
        <td>ç¢ºèªä¸­...</td>
        <td></td>
      </tr>
    </table>
  </div>

  <!-- Scripts -->
  <script src="mobile-utils.js"></script>
  <script>
    // ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã‚’è¡¨ç¤º
    function displayDeviceInfo() {
      const info = window.MobileUtils.getDeviceInfo();
      const table = document.getElementById('device-info');

      table.innerHTML = `
        <tr>
          <td>ãƒ¢ãƒã‚¤ãƒ«</td>
          <td>${info.isMobile ? 'âœ… ã¯ã„' : 'âŒ ã„ã„ãˆ'}</td>
        </tr>
        <tr>
          <td>iOS</td>
          <td>${info.isIOS ? 'âœ… ã¯ã„' : 'âŒ ã„ã„ãˆ'}</td>
        </tr>
        <tr>
          <td>Android</td>
          <td>${info.isAndroid ? 'âœ… ã¯ã„' : 'âŒ ã„ã„ãˆ'}</td>
        </tr>
        <tr>
          <td>ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³</td>
          <td>${info.isStandalone ? 'âœ… ã¯ã„' : 'âŒ ã„ã„ãˆ'}</td>
        </tr>
        <tr>
          <td>ç”»é¢å¹…</td>
          <td>${info.screenWidth}px</td>
        </tr>
        <tr>
          <td>ç”»é¢é«˜ã•</td>
          <td>${info.screenHeight}px</td>
        </tr>
        <tr>
          <td>Pixel Ratio</td>
          <td>${info.pixelRatio}</td>
        </tr>
        <tr>
          <td>ã‚¿ãƒƒãƒã‚µãƒãƒ¼ãƒˆ</td>
          <td>${info.touchSupport ? 'âœ… å¯¾å¿œ' : 'âŒ éå¯¾å¿œ'}</td>
        </tr>
      `;
    }

    // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ…‹ã‚’è¡¨ç¤º
    function testNetworkStatus() {
      const isOnline = navigator.onLine;
      const statusIndicator = document.getElementById('network-status');
      const statusText = document.getElementById('network-text');

      if (isOnline) {
        statusIndicator.className = 'status-indicator status-online';
        statusText.textContent = 'ã‚ªãƒ³ãƒ©ã‚¤ãƒ³';
      } else {
        statusIndicator.className = 'status-indicator status-offline';
        statusText.textContent = 'ã‚ªãƒ•ãƒ©ã‚¤ãƒ³';
      }
    }

    // ãƒã‚¤ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ
    function testVibrate(duration) {
      window.MobileUtils.vibrate(duration);
      showSnackbar(`${duration}msã®æŒ¯å‹•ã‚’å®Ÿè¡Œ`);
    }

    function testVibratePattern() {
      window.MobileUtils.vibrate([100, 50, 100, 50, 200]);
      showSnackbar('ãƒ‘ã‚¿ãƒ¼ãƒ³æŒ¯å‹•ã‚’å®Ÿè¡Œ');
    }

    // ã‚¹ãƒ¯ã‚¤ãƒ—ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼
    const swipeArea = document.getElementById('swipe-area');
    const swipeResult = document.getElementById('swipe-result');

    new window.MobileUtils.SwipeGesture(swipeArea, {
      onSwipeLeft: () => {
        swipeResult.textContent = 'â¬…ï¸ å·¦ã«ã‚¹ãƒ¯ã‚¤ãƒ—';
        window.MobileUtils.vibrate(30);
      },
      onSwipeRight: () => {
        swipeResult.textContent = 'â¡ï¸ å³ã«ã‚¹ãƒ¯ã‚¤ãƒ—';
        window.MobileUtils.vibrate(30);
      },
      onSwipeUp: () => {
        swipeResult.textContent = 'â¬†ï¸ ä¸Šã«ã‚¹ãƒ¯ã‚¤ãƒ—';
        window.MobileUtils.vibrate(30);
      },
      onSwipeDown: () => {
        swipeResult.textContent = 'â¬‡ï¸ ä¸‹ã«ã‚¹ãƒ¯ã‚¤ãƒ—';
        window.MobileUtils.vibrate(30);
      }
    });

    // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬
    function measurePerformance() {
      const monitor = new window.MobileUtils.PerformanceMonitor();
      const metrics = monitor.measurePageLoad();

      const metricsGrid = document.getElementById('performance-metrics');
      metricsGrid.innerHTML = `
        <div class="metric-card">
          <div class="metric-value">${metrics.domContentLoaded || '--'}ms</div>
          <div class="metric-label">DOMèª­ã¿è¾¼ã¿</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">${metrics.loadComplete || '--'}ms</div>
          <div class="metric-label">å®Œå…¨èª­ã¿è¾¼ã¿</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">${metrics.firstPaint || '--'}ms</div>
          <div class="metric-label">First Paint</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">${metrics.firstContentfulPaint || '--'}ms</div>
          <div class="metric-label">FCP</div>
        </div>
      `;

      showSnackbar('âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è¨ˆæ¸¬ã—ã¾ã—ãŸ');
    }

    // PWAçŠ¶æ…‹ã‚’è¡¨ç¤º
    async function displayPWAStatus() {
      const swStatus = document.getElementById('sw-status');
      const standaloneStatus = document.getElementById('standalone-status');
      const installedStatus = document.getElementById('installed-status');

      // Service Worker
      if ('serviceWorker' in navigator) {
        const registration = await navigator.serviceWorker.getRegistration();
        swStatus.textContent = registration ? 'âœ… ç™»éŒ²æ¸ˆã¿' : 'âŒ æœªç™»éŒ²';
      } else {
        swStatus.textContent = 'âŒ éå¯¾å¿œ';
      }

      // ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ãƒ¢ãƒ¼ãƒ‰
      const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
      standaloneStatus.textContent = isStandalone ? 'âœ… ã¯ã„' : 'âŒ ã„ã„ãˆ';

      // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ï¼ˆæ¨æ¸¬ï¼‰
      installedStatus.textContent = isStandalone ? 'âœ… ã¯ã„' : 'â“ ä¸æ˜';
    }

    // ãƒãƒƒãƒ†ãƒªãƒ¼æƒ…å ±ã‚’è¡¨ç¤º
    async function displayBatteryInfo() {
      const table = document.getElementById('battery-info');

      if ('getBattery' in navigator) {
        try {
          const battery = await navigator.getBattery();

          table.innerHTML = `
            <tr>
              <td>ãƒãƒƒãƒ†ãƒªãƒ¼æ®‹é‡</td>
              <td>${Math.round(battery.level * 100)}%</td>
            </tr>
            <tr>
              <td>å……é›»ä¸­</td>
              <td>${battery.charging ? 'âœ… ã¯ã„' : 'âŒ ã„ã„ãˆ'}</td>
            </tr>
            <tr>
              <td>å……é›»æ™‚é–“</td>
              <td>${battery.chargingTime === Infinity ? 'ä¸æ˜' : battery.chargingTime + 'ç§’'}</td>
            </tr>
            <tr>
              <td>æ”¾é›»æ™‚é–“</td>
              <td>${battery.dischargingTime === Infinity ? 'ä¸æ˜' : battery.dischargingTime + 'ç§’'}</td>
            </tr>
          `;
        } catch (error) {
          table.innerHTML = '<tr><td colspan="2">å–å¾—å¤±æ•—</td></tr>';
        }
      } else {
        table.innerHTML = '<tr><td colspan="2">âŒ éå¯¾å¿œ</td></tr>';
      }
    }

    // åˆæœŸåŒ–
    window.addEventListener('load', () => {
      displayDeviceInfo();
      testNetworkStatus();
      displayPWAStatus();
      displayBatteryInfo();
      measurePerformance();
    });

    // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ…‹ã®ç›£è¦–
    window.addEventListener('online', testNetworkStatus);
    window.addEventListener('offline', testNetworkStatus);
  </script>
</body>
</html>
